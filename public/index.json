[{"content":"\u003cimg src=\"https://sm.ign.com/ign_es/tag/s/steam/steam_rbez.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\n\u003cp\u003eLa idea principal de este post es analizar los inicios de la preparación de datos en datasets reales con grandes cantidades de información.\nPara esto se eligió el dataset de \u003cem\u003e\u003ca href=\"https://www.kaggle.com/datasets/antonkozyriev/game-recommendations-on-steam\"\u003erecomendaciones de juegos en Steam\u003c/a\u003e\u003c/em\u003e (plataforma de distribución digital de videojuegos), el cual cuenta con datos oficiales de la plataforma, y según la descripción del mismo esta compuesto por mas de 41 millones de recomendaciones de usuarios de Steam.\u003c/p\u003e\n\u003ch3 id=\"preparacion-de-datos\"\u003ePreparacion de datos\u003c/h3\u003e\n\u003cp\u003eEste dataset contiene 3 CSVs, uno de juegos, otro de recomendaciones, y otro de usuarios, y tambien contiene un archivo json con metadata de los juegos.\nPara comenzar con la preparación de datos, es importante conocer el dataset. Esto permitirá en primera instancia entender qué es lo que se puede hacer con los datos, y una vez definido el objetivo, validar qué predictores son los más importantes para poder alcanzarlo.\nAl tener 3 CSVs, será necesario también encontrar puntos en común para poder correlacionarlos, y de esa forma poder utilizar toda la información posible, lo que ayudará a conseguir un mejor resultado.\u003c/p\u003e\n\u003ch3 id=\"análisis-de-predictores\"\u003eAnálisis de predictores\u003c/h3\u003e\n\u003ch5 id=\"csv-de-juegos\"\u003eCSV de juegos:\u003c/h5\u003e\n\u003cp\u003eEste CSV contiene datos acerca de una gran variedad de juegos de Steam. Dentro de los campos que este tiene se encuentran:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eapp_id\u003c/strong\u003e: ID del juego en Steam. Este campo será importante para poder \u0026ldquo;mergear\u0026rdquo; los datasets (luego se verá que tanto el json con metadata como el CSV de recomendaciones referencian este app_id) (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003etitle\u003c/strong\u003e: Nombre del juego. Notar que algunos nombres tienen mal el formato en excel, principalmente los que utilizan simbolos como \u003cem\u003etm\u003c/em\u003e (trademark) o \u003cem\u003ecopyright\u003c/em\u003e, pero dentro de un editor de texto se ven bien (lo que implica que hay que tener cuidado con el formato de caractéres disponibles a elegir). Tambien existen juegos en lenguajes con otros alfabetos, a primera vista se encuentran ejemplos como chino y japones.\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edate_release\u003c/strong\u003e: Fecha de salida del juego. En excel se pueden ver algunos campos marcados con ######, pero abiertos con un editor de texto se pueden ver las fechas sin problema (el formato es año-mes-dia)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ewin\u003c/strong\u003e: Indica si el juego es soportado por el sistema operativo Windows (campo booleano)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003emac\u003c/strong\u003e: Indica si el juego es soportado por el sistema operativo Mac (campo booleano)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003elinux\u003c/strong\u003e: Indica si el juego es soportado por el sistema operativo Linux (campo booleano)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003erating\u003c/strong\u003e: Que tanto recomienda la gente un juego (campo categórico polinomial, con categorías como: Positive, Very Positive, Mixed, Mostly Positive, Mostly Negative)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003epositive_ratio\u003c/strong\u003e: Ratio de feedback positivo (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003euser_reviews\u003c/strong\u003e: Cantidad de reviews de usuarios (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eprice_final\u003c/strong\u003e: Precio en dolares (campo real)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eprice_original\u003c/strong\u003e: Precio original del juego en dolares (previo al descuento), suele ser igual al \u003cem\u003eprice_final\u003c/em\u003e (campo real)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ediscount\u003c/strong\u003e: Descuento que se le hace al juego. Si el juego esta descontado, disminuye el \u003cem\u003eprice_final\u003c/em\u003e, lo que hace que sea distinto a \u003cem\u003eprice_original\u003c/em\u003e (campo real)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003esteam_deck\u003c/strong\u003e: Si el juego esta disponible o no para la Steam Deck (campo booleano)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"csv-de-usuarios\"\u003eCSV de usuarios:\u003c/h5\u003e\n\u003cp\u003eEste CSV contiene información (anonimizada) acerca de usuarios registrados en Steam:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003euser_id\u003c/strong\u003e: ID de usuario autogenerada (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eproducts\u003c/strong\u003e: Cantidad de juegos comprados por el usuario (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ereviews\u003c/strong\u003e: Cantidad de reviews publicadas (campo integer)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"csv-de-recomendaciones\"\u003eCSV de recomendaciones:\u003c/h5\u003e\n\u003cp\u003eEste CSV contiene información acerca de las recomendaciones de los usuarios sobre un juego en particular:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eapp_id\u003c/strong\u003e: ID del juego en Steam (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ehelpful\u003c/strong\u003e: Cantidad de usuarios que encontraron la recomendación útil (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003efunny\u003c/strong\u003e: Cantidad de usuarios que encontraron la recomendación graciosa (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edate\u003c/strong\u003e: Fecha de publicación (formato año-mes-día)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eis_recommended\u003c/strong\u003e: Si el usuario recomienda o no el juego (campo booleano)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ehours\u003c/strong\u003e: Cuantas horas jugó el usuario al juego (campo real)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003euser_id\u003c/strong\u003e: ID de usuario en Steam (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ereview_id\u003c/strong\u003e: ID autogenerado de las reviews (campo integer)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"json-de-metadata\"\u003eJSON de metadata:\u003c/h5\u003e\n\u003cp\u003eEste JSON profundiza y agrega información acerca de algunos de los juegos del CSV de juegos, con los siguientes datos:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eapp_id\u003c/strong\u003e: ID del juego en Steam (campo integer)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edescription\u003c/strong\u003e: Descripción del juego (campo string)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003etags\u003c/strong\u003e: Lista de géneros del juego (campo categórico, con algunos ejemplos como: \u003cem\u003eAction\u003c/em\u003e, \u003cem\u003eSingleplayer\u003c/em\u003e, \u003cem\u003eHack and Slash\u003c/em\u003e, \u003cem\u003eController\u003c/em\u003e, entre otros)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eUna vez analizados y entendidos todos los datos, se puede evaluar qué campos son los que nos interesan predecir. El caso más interesante sería el de ser capaz de predecir qué juego le puede llegar a gustar a una persona (recomendación de juegos).\nDado que la cantidad de datos en este dataset es tan grande, es de interés saber si podemos eliminar algun predictor que sepamos que no va a ser de utilidad. De esta forma podemos alivianar la carga sobre el modelo, ahorrando tiempo y costos de procesamiento. Para saber que predictores serán útiles para la tarea, se debe encontrar una forma de saber si a un usuario le podría gustar un juego o no. A lo largo de este proyecto se consideraron dos formas para recomendar juegos:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSaber que juegos suelen jugar otros usuarios similares (por ejemplo los juegos que tienen o recomiendan sus amigos, otros usuarios de su mismo país, etc.)\u003c/li\u003e\n\u003cli\u003eRecomendar juegos que tengan metadata similar a los que el usuario ya ha jugado y recomendado previamente\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"primer-approach\"\u003ePrimer approach\u003c/h3\u003e\n\u003cp\u003eLo primero que se intentó fue mergear los tres CSVs y el JSON utilizando pandas, con el objetivo de poder ver de forma unificada la información, y para poder envíarsela a RapidMiner o a un modelo en Python de forma sencilla y poder trabajar sobre el mismo conjunto de datos.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-Python\" data-lang=\"Python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e pandas \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e pd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e json\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# leo los tres CSVs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egames \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;games.csv\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003erecommendations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;recommendations.csv\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eusers \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;users.csv\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# leo el JSON y lo convierto en un dataframe (tambien se puede usar pd.read_json())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ejson_file_path \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;games_metadata.json\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003ewith\u003c/span\u003e open(json_file_path, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;r\u0026#39;\u003c/span\u003e, encoding\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;utf-8\u0026#39;\u003c/span\u003e) \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e f:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    json_data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e [json\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eloads(line) \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e line \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e f]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf_metadata \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eDataFrame(json_data)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ahora que está todo en el mismo formato, puedo mergear los dataframes usando app_id y user_id\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egames_recommendations \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emerge(recommendations, games, on\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;app_id\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efull_data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emerge(games_recommendations, users, on\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;user_id\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efull_data_metadata \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003emerge(full_data, df_metadata, on\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;app_id\u0026#39;\u003c/span\u003e, how\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;left\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efull_data_metadata\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eto_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;steam_data.csv\u0026#39;\u003c/span\u003e, index\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprint(full_data_metadata\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ehead())\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e(también es posible mergear los CSVs desde RapidMiner, pero consume una enorme cantidad de recursos, y de faltar no permite continuar con la ejecución del bloque)\u003c/p\u003e\n\u003cp\u003eEl problema de este approach es que se genera un CSV con una cantidad de datos tan grande que RapidMiner, Excel, e incluso a editores de texto les cuesta incluso leerlo. Por lo tanto, se debe encontrar una forma de achicar los CSVs previo al mergeo.\u003c/p\u003e\n\u003ch3 id=\"segundo-approach\"\u003eSegundo approach\u003c/h3\u003e\n\u003cp\u003eDado que simplemente mergear todos los datos resultó inviable, el siguiente paso fue buscar si habían filas que podrían no ser enviadas al modelo. Por ejemplo, los tags son absolutamente necesarios para poder realizar recomendaciones en base al género de un juego, por lo que si un juego no tiene tags, entonces se puede descartar el juego, dado que falta información suficiente como para recomendarlo (se pueden utilizar otros campos, pero la recomendación no será tan acertada). Por lo tanto, se puede reducir la cantidad de datos en gran medida removiendo las filas que no poseen tags. Tambien es posible aprovechar y remover las filas que tienen descripción vacía, para intentar reducir la cantidad de datos.\nY aún así, la cantidad de datos sigue siendo muy grande. Por esta razón, se creó un script que aparte de remover las filas con una descripción y una lista de tags vacía, segmenta el CSV resultante en distintos CSVs, dando como resultado unos aproximadamente 400 CSVs, cada uno con una porción del CSV original.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-Python\" data-lang=\"Python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e dask.dataframe \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e dd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e numpy \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e np\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edtype \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e {\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;description\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;object\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;tags\u0026#39;\u003c/span\u003e: \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;object\u0026#39;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e}\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e dd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;steam_data.csv\u0026#39;\u003c/span\u003e, dtype\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003edtype)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# cambio las descripiones vacías por NaN\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;description\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;description\u0026#39;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e, np\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003enan)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# borro las filas donde los tags sean \u0026#39;[]\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;tags\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e!=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;[]\u0026#39;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# borro las filas que tengan NaN en la descripción\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edropna(subset\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;description\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Esta línea aparte de guardar el CSV lo divide en múltiples archivos (cleaned_dataset_1.csv, cleaned_dataset_2.csv, etc.)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eto_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cleaned_dataset_*.csv\u0026#39;\u003c/span\u003e, index\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"siguiendo-con-el-análisis\"\u003eSiguiendo con el análisis\u0026hellip;\u003c/h3\u003e\n\u003cp\u003eCon este último paso ya se comienza a poseer una cantidad de datos manejable, que se puede introducir en RapidMiner para comenzar con el desarrollo del proceso. Pero esto si solo se considera el tamaño del dataset.\nOtro problema que surge es que aún con estos cambios RapidMiner no lo puede procesar, porque los géneros no dejan de ser una lista de tags separados por coma, lo que al momento de mergear con los CSVs genera un archivo que, al ingresar al RapidMiner, no sabe hasta donde llega cada columna, y por lo tanto genera errores.\nPara solucionar esto hay varios caminos. El primero sería sustituir las comas por otro símbolo en la lista de tags. Esto soluciona el problema del parseo, pero queda pendiente el ver como se puede formatear el dato para que un modelo de machine learning lo pueda procesar.\nPor otro lado, el segundo camino sería llevar cada uno de los tags a una columna binaria (mediante One-Hot Encoding). Este segundo approach permite que la información se guarde de forma más estructurada y en números binarios, que dependiendo del algoritmo de ML que se utilice, esto podría ser una ventaja, ya que aún siendo números no tendrán un orden definido.\u003c/p\u003e\n\u003ch4 id=\"bibliografía\"\u003eBibliografía\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.kaggle.com/datasets/antonkozyriev/game-recommendations-on-steam\"\u003eDataset\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"http://pandas.pydata.org/pandas-docs/version/1.5/reference/api/pandas.DataFrame.dropna.html\"\u003ePandas docs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://stackoverflow.com/questions/29314033/drop-rows-containing-empty-cells-from-a-pandas-dataframe\"\u003eRemover celdas vacías\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.kaggle.com/code/felipereisdesouza/recommended-game-genres\"\u003eOtros estudios del dataset\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.kaggle.com/code/thakursankalp/steam-game-recommendation-engine\"\u003eOtros estudios del dataset\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","description":null,"image":null,"permalink":"https://seba-quintana.github.io/ML-Portfolio/blogs/steam/","title":"Recomendaciones de juegos"},{"content":"\u003cimg src=\"https://lieber.westpoint.edu/wp-content/uploads/2022/06/a-us-anti-personnel-mine-used-during-a-marine-field-exercise-3ee3a0-1024-resized.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\r\n\u003cp\u003eLa idea de este post es intentar crear varios modelos de Machine Learning que permitan predecir si el resultado de un análisis de un sonar es una roca o una mina. Este modelo es inherentemente de clasificación, ya que la variable objetivo será el atributo que determine si es una mina o no (llamado \u003ccode\u003eclass\u003c/code\u003e), y por lo tanto se realizará un análisis de los distintos modelos de clasificación (bajo las mismas condiciones), para evaluar qué modelo se ajusta mejor a este caso en particular. Notar que no se realizará preparación de datos previa, justamente para identificar ventajas y desventajas de los distintos modelos (por ejemplo, algunos serán perjudicados por la distribución de los datos, mientras que otros son más resistentes a esto. O quizás la falta de normalización o el tipo de datos de las entradas afecte de manera negativa a algún modelo pero a otros no, etc.).\u003c/p\u003e\n\u003ch3 id=\"análisis-de-datos\"\u003eAnálisis de datos\u003c/h3\u003e\n\u003cp\u003ePara poder ver si un elemento es una roca o una mina, se utiliza un sonar que emite distintas frecuencias. Según cómo vuelvan esas frecuencias, el sonar puede detectar el objeto. En este caso, el dataset viene con 60 frecuencias distintas, y con los resultados que las mismas tuvieron frente a distintos objetos. Notar que dichas frecuencias son números reales.\u003c/p\u003e\n\u003ch3 id=\"proceso-de-rapidminer\"\u003eProceso de RapidMiner\u003c/h3\u003e\n\u003cp\u003ePara realizar esta prueba, se mantendrán las mismas configuraciones para todos los modelos. En el proceso se utilizará un cross-validation para separar la data de training de la data para testing, con 10 folds y una semilla de 2000. Dentro del cross-validation se utilizarán los datos de training para entrenar los distintos modelos de clasificación, y se calculará la performance del resultado.\u003c/p\u003e\n\u003cimg src=\"../../images/Process2.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\r\n\u003cp\u003eEn el caso de las minas, si el modelo predice correctamente que es una mina se podrá desarmar, si el modelo predice correctamente que es una piedra no pasará nada, y si predice que es una mina pero era una piedra termina siendo una falsa alarma, que no es el caso deseado, pero en todo caso no hay peligro real. Por lo tanto, el peor resultado posible para el modelo son los casos donde el modelo predice piedra y hay una mina, dado que llevará a un resultado catastrófico.\u003c/p\u003e\n\u003cp\u003eNotar que no hubo procesamiento previo de los datos, ya que el objetivo es comparar el comportamiento de los modelos, no necesariamente conseguir el mejor valor posible. Esto es importante porque este dataset posee valores reales en todos sus predictores, lo que será manejado de distinta manera por cada modelo (hay modelos que se comportan mejor frente a valores numéricos que otros), y puede llevar a diferentes resultados.\u003c/p\u003e\n\u003ch3 id=\"naive-bayes\"\u003eNaive Bayes\u003c/h3\u003e\n\u003cp\u003eProceso utilizando Naive Bayes:\u003c/p\u003e\n\u003cimg src=\"../../images/Naive_Bayes.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\r\n\u003cp\u003eMatriz de confusión:\n\u003cimg src=\"../../images/Naive_Bayes_Perf.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\u003c/p\u003e\n\u003cp\u003eEn este caso, se puede ver que Naive Bayes tiene un 67% de exactitud, lo que no es ideal, pero no es un mal resultado siendo que no hubo procesamiento previo de los datos. Aunque si tenemos en cuenta solamente el caso en el que la mina realmente existe, vemos que tiene una exactitud de aproximadamente 55%, lo que quiere decir que cuando la mina existe, al modelo le cuesta darse cuenta, lo que no es nada bueno.\u003c/p\u003e\n\u003ch3 id=\"desicion-trees\"\u003eDesicion Trees\u003c/h3\u003e\n\u003cp\u003eProceso utilizando Desicion Trees:\u003c/p\u003e\n\u003cimg src=\"../../images/Desicion_Tree.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\r\n\u003cp\u003eMatriz de confusión:\n\u003cimg src=\"../../images/Desicion_Tree_Perf.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\u003c/p\u003e\n\u003cp\u003eCon árboles de desición el porcentaje es bastante menor que en Naive Bayes, con un porcentaje de 62% de exactitud, pero por otro lado, tiene un aproximadamente 67% de exactitud a la hora de predecir minas reales, lo que se podría considerar una mejora frente a Naive Bayes.\u003c/p\u003e\n\u003ch3 id=\"logistic-regression\"\u003eLogistic Regression\u003c/h3\u003e\n\u003cp\u003eProceso utilizando Logistic Regression:\u003c/p\u003e\n\u003cimg src=\"../../images/Logistic_Regression.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\r\n\u003cp\u003eMatriz de confusión:\n\u003cimg src=\"../../images/Logistic_Regression_Perf.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\u003c/p\u003e\n\u003cp\u003eLa regresión logística en términos simples consiste en utilizar una función que tiene un umbral, donde si el valor es menor al umbral se considera de una clase, y si es mayor se considera de la otra. Se puede ver que tiene una performance bastante mayor a la de Naive Bayes y Desicion Trees, dado que no solo tiene una exactitud del 71%, si no que también es mejor detectando tanto piedras como minas. En el caso de haber una mina, tiene un 71% de exactitud para detectarla, lo que es una mejora en todo sentido frente a los casos anteriores.\u003c/p\u003e\n\u003cp\u003eEsto probablemente se deba a que, al contrario de los otros dos modelos, la regresión logística es capaz de operar con valores continuos como lo son los números reales, lo que conlleva a un mejor rendimiento en estos casos. Los otros dos modelos soportan números reales, pero podrían tener un mejor comportamiento si separaramos las distintas frecuencias en rangos, para generar una menor cantidad de clases y que les resulte más sencillo relacionar los datos.\u003c/p\u003e\n\u003ch3 id=\"lda\"\u003eLDA\u003c/h3\u003e\n\u003cp\u003eProceso utilizando Linear Discriminant Analysis:\u003c/p\u003e\n\u003cimg src=\"../../images/LDA.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\r\n\u003cp\u003eMatriz de confusión:\n\u003cimg src=\"../../images/LDA_Perf.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\u003c/p\u003e\n\u003cp\u003eEste caso supera todos los modelos anteriores, con un 77% de exactitud total, e incluso un 81% en el caso de ser una mina. LDA crea un nuevo eje que maximiza la separación entre las clases. En este contexto, lo que busca es determinar si un nuevo elemento se acerca más a la media de los elementos clasificados como rocas o a la media de los clasificados como minas, y en base a esto realiza la predicción.\u003c/p\u003e\n\u003ch3 id=\"k-nn\"\u003eK-NN\u003c/h3\u003e\n\u003cp\u003eProceso utilizando K-NN:\u003c/p\u003e\n\u003cimg src=\"../../images/KNN.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\r\n\u003cp\u003eMatriz de confusión:\n\u003cimg src=\"../../images/KNN_Perf.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\u003c/p\u003e\n\u003cp\u003eAquí se puede ver que este modelo ha tenido la mejor performance de todos los modelos hasta ahora, con un 81% de exactitud en total, y si el objetivo a analizar es una mina resulta tener un 87% de exactitud, lo cual es bastante alto, considerando que no se buscó optimizar el modelo ni preparar los datos previamente.\u003c/p\u003e\n\u003ch3 id=\"análisis-de-resultados\"\u003eAnálisis de Resultados\u003c/h3\u003e\n\u003cp\u003eUna de las posibles razones por las que los modelos K-NN y LDA funcionan tan bien en comparación a los otros modelos puede ser porque las dos clases se encuentran muy separadas:\n\u003cimg src=\"../../images/LDA_Chart.jpeg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\nOtra posibilidad es que los datos se aproximan a una distribución normal, lo que mejora el funcionamiento de LDA:\n\u003cimg src=\"../../images/LDA_Distr.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\nPor otro lado, Naive Bayes puede tener un comportamiento peor porque asume que los datos son condicionalmente independientes, lo que no necesariamente se cumple en este caso, mientras que la regresión logística y LDA son más resistentes a esto.\nEn el caso de los árboles de desición, quizá esté tendiendo a sobreajustar por el tamaño del dataset o por el ruido, mientras que tanto K-NN como LDA y regresión logística son más resistentes al sobreajuste por ruido.\u003c/p\u003e\n\u003cp\u003ePor último, K-NN es el modelo que mejor pudo predecir la variable objetivo. Esto se puede deber a distintas razones:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eK-NN no pierde exactitud según la distribución de los datos, lo que hace que su performance sea mejor que la de LDA\u003c/li\u003e\n\u003cli\u003eComo LDA se basa en promedios y K-NN en los nodos cercanos, K-NN se ve beneficiado con datasets chicos donde las clases similares se encuentran cerca, dado que LDA calcula el promedio de todos los datos. Esto también quiere decir que se ve mayormente afectado por outliers que K-NN, dado que con un valor pequeño de K, K-NN toma en cuenta una menor cantidad de outliers que LDA.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"para-seguir-comparando\"\u003ePara seguir comparando\u0026hellip;\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eSe pueden añadir nuevos modelos a la comparación, como SVM o Random Forest\u003c/li\u003e\n\u003cli\u003eSe pueden ajustar los parámetros de los modelos (en este caso todos los parámetros fueron los predeterminados)\u003c/li\u003e\n\u003cli\u003eSe puede realizar un procesamiento de datos previo, que dependerá de que modelo se utilice para aprovechar las ventajas de cada uno\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"bibliografía\"\u003eBibliografía\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003eDataset Sonar de RapidMiner\u003c/li\u003e\n\u003c/ul\u003e\n","description":null,"image":null,"permalink":"https://seba-quintana.github.io/ML-Portfolio/blogs/landmines/","title":"¿Es una mina?"},{"content":"\u003cimg src=\"https://upload.wikimedia.org/wikipedia/commons/9/90/ThinkPad_X220.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\n\u003cp\u003eEl propósito de este post es realizar un proyecto que demuestre de comienzo a fin un proceso de Machine Learning, el cual permitirá realizar tareas de predicción sobre un campo en concreto. En este caso se buscará predecir el precio que tendrá una laptop, basándose en las distintas características de la misma.\u003c/p\u003e\n\u003ch3 id=\"preparacion-de-datos\"\u003ePreparacion de datos\u003c/h3\u003e\n\u003cp\u003eEl primer paso en un proceso de Machine Learning siempre es conseguir los datos. Para esto se puede utilizar un repositorio como UCI o Kaggle para extraer los mismos, los cuales suelen estar en formato CSV (aunque no necesariamente). Para este caso en particular existen muchos datasets que pueden ser útiles, de los cuales se ha elegido el de \u003cem\u003e\u003ca href=\"https://www.kaggle.com/datasets/muhammetvarl/laptop-price\"\u003elaptop_prices\u003c/a\u003e\u003c/em\u003e. El mismo contiene un CSV con los siguientes campos:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eCompany\u003c/code\u003e - String - Laptop Manufacturer\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eProduct\u003c/code\u003e - String - Brand and Model\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTypeName\u003c/code\u003e - String - Type (Notebook, Ultrabook, Gaming, etc.)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eInches\u003c/code\u003e - Numeric - Screen Size\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eScreenResolution\u003c/code\u003e - String - Screen Resolution\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eCpu\u003c/code\u003e - String - Central Processing Unit (CPU)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eRam\u003c/code\u003e - String - Laptop RAM\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eMemory\u003c/code\u003e - String - Hard Disk / SSD Memory\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eGPU\u003c/code\u003e - String - Graphics Processing Units (GPU)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eOpSys\u003c/code\u003e - String - Operating System\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eWeight\u003c/code\u003e - String - Laptop Weight\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePrice_euros\u003c/code\u003e - Numeric - Price (Euro)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e(Campos directamente extraídos de la documentación del dataset)\u003c/p\u003e\n\u003cp\u003eDe esta información, lo que interesa predecir, la variable objetivo, es \u003ccode\u003ePrice_euros\u003c/code\u003e. Por lo tanto, al ser una variable numérica, implica que se tendrá que utilizar algún modelo de regresión.\u003c/p\u003e\n\u003ch4 id=\"feature-selection\"\u003eFeature selection\u003c/h4\u003e\n\u003cp\u003ePrevio al análisis de los datos, se puede ver si existe alguna columna que pueda ser removida del dataset, principalmente columnas que, o no aporten para predecir la variable objetivo, o que tengan algún problema por el que no pueda ser usada. En este caso, se puede ver a simple vista que el nombre del modelo (\u003ccode\u003eProduct\u003c/code\u003e) de la laptop no resulta útil, dado que lo más importante para predecir el precio son los componentes de la laptop y la marca, los cuales ya existen en el dataset. El modelo en particular no suele añadir una gran diferencia en el precio por sí mismo.\u003c/p\u003e\n\u003cp\u003eOtro ejemplo de columna que se puede remover es la de \u003ccode\u003eTypeName\u003c/code\u003e. A simple vista uno podría pensar que esta columna es importante, ya que una computadora para gaming será más cara que una simple Notebook, pero en realidad si la computadora para gaming es más cara, es por los componentes, los cuales ya están siendo considerados. Por lo tanto, se puede remover la columna, ya que existe una correlación entre dichas columnas.\u003c/p\u003e\n\u003ch3 id=\"análisis-de-datos\"\u003eAnálisis de datos\u003c/h3\u003e\n\u003cp\u003ePara comenzar a analizar los datos, es recomendable ver si el formato de los mismos es correcto. Por ejemplo, en este caso el peso (\u003ccode\u003eWeight\u003c/code\u003e) esta en kilogramos, teniendo filas con el formato \u003cpeso\u003ekg, y es considerado por RapidMiner como una variable categórica, cuando en verdad podría ser una variable numérica. El problema de esto es que se genera una gran cantidad de clases diferentes, lo que puede complicar a la hora de encontrar patrones, ya que para el modelo todas las clases son distintas. Lo mismo sucede con la \u003ccode\u003eRAM\u003c/code\u003e (aunque no tiene tantas clases).\u003c/p\u003e\n\u003cp\u003eOtro problema (e incluso más importante), es que si el modelo solo acepta valores numéricos entonces no podremos ingresarle dichas clases. Por lo tanto (y de poderse) podría ser conveniente convertir todas las clases a valores númericos.\u003c/p\u003e\n\u003cp\u003ePor otro lado la \u003ccode\u003eCPU\u003c/code\u003e es un dato categórico, que es de vital importancia para predecir el precio de una laptop. El problema de la \u003ccode\u003eCPU\u003c/code\u003e es que su nombre varia mucho por los distintos modelos, sus velocidades, generaciones, etc., por lo que se debe modificar para que el modelo provea un mejor resultado. Hay muchas técnicas que se pueden aplicar en este tipo de casos, como por ejemplo la agrupación de categorías o One-Hot Encoding. En este caso se utilizará One-Hot Encoding, el cual implica separar en distintas columnas las distintas clases presentes, y que cada una posea un valor binario. Por ejemplo, si solo hay procesadores Intel y AMD, existirán dos columnas, y si una laptop tiene procesador Intel entonces tendrá un 1 en Intel y un 0 en AMD. Como las \u003ccode\u003eCPU\u003c/code\u003e contienen no solo la marca, si no también el modelo y la velocidad, se pueden separar también en distintas columnas utilizando la misma técnica. Esto quedaría como una columna llamada \u003ccode\u003eCPU\u003c/code\u003e, otra \u003ccode\u003eCPU_Freq\u003c/code\u003e, y otra \u003ccode\u003eCPU_Gen\u003c/code\u003e. Con este cambio, \u003ccode\u003eCPU\u003c/code\u003e ahora tendrá Intel o AMD en lugar de Intel Core i5 7500U 2.1GHz, lo que es una mejora, pero se puede volver a realizar One-Hot Encoding, esta vez con las marcas, para así poder tener valores numéricos. Esto resulta en una columna Intel, otra columna AMD, etc.\nPara las generaciones se pueden agrupar en grupos grandes, como por ejemplo i3, i5, i7, A9, Ryzen, y otros, y aunque no se contemplan todos los casos en detalle, si se toman en cuenta los modelos más usados.\u003c/p\u003e\n\u003cp\u003eEn el caso de la marca, también se realizara One-Hot Encoding. Otra opción podría ser pasar las distintas clases a números, pero esto implicaría darles un orden a las clases, y al no tener un orden inherente, el modelo puede llegar a pensar que hay una relación según el orden de las clases cuando en realidad no la hay (por ejemplo, podría pensar que Google es más parecido a Apple que a HP solamente porque los números de Google y Apple están más cerca entre ellos que de HP, cuando en realidad no es así).\u003c/p\u003e\n\u003cp\u003eLo mismo se puede realizar con el sistema operativo.\u003c/p\u003e\n\u003cp\u003ePara la \u003ccode\u003eScreenResolution\u003c/code\u003e se puede tomar el tamaño de la pantalla, y quedarse con el ancho y el alto. Luego de analizar la columna, el otro dato interesante que tiene es si es IPS o no (se puede sacar con One-Hot Encoding). No existen laptops TN, VA, u OLED en el dataset, y si es Full HD, 4k, etc. se puede sacar de la resolución de la pantalla.\u003c/p\u003e\n\u003cp\u003eCon respecto a la \u003ccode\u003eGPU\u003c/code\u003e, al tener muchas clases muy utilizadas, se puede filtrar en excel las que se repiten más de una cierta cantidad de veces, y únicamente tomar esas. Notar que si se utiliza demasiado One-Hot Encoding puede resultar en una matriz muy esparsa, lo que dependiendo del modelo puede empeorar su performance.\u003c/p\u003e\n\u003cp\u003eSe puede seguir este proceso hasta conseguir que todos los predictores sean valores numéricos que el modelo pueda utilizar.\u003c/p\u003e\n\u003cp\u003eEl código utilizado para estos ajustes es el siguiente:\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#f92672\"\u003eimport\u003c/span\u003e pandas \u003cspan style=\"color:#66d9ef\"\u003eas\u003c/span\u003e pd\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Read the file\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eread_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;./laptop_price.csv\u0026#39;\u003c/span\u003e, encoding\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ISO-8859-1\u0026#39;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Manual feature selection\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;laptop_ID\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Product\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;TypeName\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# One-Hot encoding with companies\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eCompany_dummies \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget_dummies(df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Company\u0026#34;\u003c/span\u003e])\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(int)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econcat([df, Company_dummies], axis\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Company\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Grab panel type and screen resolution\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;first_word\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ScreenResolution\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;last_word\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ScreenResolution\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr[\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Function to parse the resolution and determine if it\u0026#39;s IPS or Touchscreen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eparse_resolution\u003c/span\u003e(row):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    resolution \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e row[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;last_word\u0026#39;\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    is_ips \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e row[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;first_word\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e==\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;IPS\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003etry\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        width, height \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e map(int, resolution\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;x\u0026#39;\u003c/span\u003e))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSeries([width, height, is_ips])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eexcept\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eValueError\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Handle cases where resolution parsing fails\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSeries([\u003cspan style=\"color:#66d9ef\"\u003eNone\u003c/span\u003e, \u003cspan style=\"color:#66d9ef\"\u003eNone\u003c/span\u003e, is_ips])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ehas_touchscreen\u003c/span\u003e(description):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Touchscreen\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e description \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Create the new feature\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Touchscreen\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ScreenResolution\u0026#39;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eapply(has_touchscreen)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Apply resolution to df\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Width\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Height\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;IPS\u0026#39;\u003c/span\u003e]] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eapply(parse_resolution, axis\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;first_word\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;last_word\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;ScreenResolution\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Parse CPU\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CPU_Brand\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Cpu\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# One-Hot Encoding with CPU Brand\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecpu_dummies \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget_dummies(df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CPU_Brand\u0026#34;\u003c/span\u003e], prefix\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;CPU\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(int)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econcat([df, cpu_dummies], axis\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CPU_Freq\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Cpu\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr[\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e]\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CPU_Freq\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CPU_Freq\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr[:\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(float)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CPU_Model\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Cpu\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#e6db74\"\u003er\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;^\\w+\\s+\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e, regex\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eTrue\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#e6db74\"\u003er\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\s+\\d+GHz$\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e, regex\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eTrue\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estrip()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Group by Brand and Model Family\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup_cpu_model\u003c/span\u003e(model):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;i3\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e model:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Intel_i3\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;i5\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e model:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Intel_i5\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;i7\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e model:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Intel_i7\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;A9-Series\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e model:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;AMD_A9\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Ryzen\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e model:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;AMD_Ryzen\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Other\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;CPU_Gen\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;CPU_Model\u0026#39;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eapply(group_cpu_model)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# One-Hot Encoding with CPU_Gen\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egen_dummies \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget_dummies(df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;CPU_Gen\u0026#34;\u003c/span\u003e])\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(int)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econcat([df, gen_dummies], axis\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Cpu\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;CPU_Model\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;CPU_Gen\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;CPU_Brand\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Remove GB from RAM and convert to number\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;RAM\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Ram\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr[:\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(int)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Ram\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Function to process storage and separate SSD, HDD, and Flash\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eprocess_storage\u003c/span\u003e(storage):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    total_ssd_mb \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    total_hdd_mb \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    total_flash_mb \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#75715e\"\u003e# Split by \u0026#39;+\u0026#39; for combined storage\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003efor\u003c/span\u003e part \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e storage\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;+\u0026#39;\u003c/span\u003e):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        part \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e part\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estrip()  \u003cspan style=\"color:#75715e\"\u003e# Remove extra spaces\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#75715e\"\u003e# Check for TB, GB, or MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;TB\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            capacity \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e int(float(part\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;TB\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estrip()\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]) \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e)  \u003cspan style=\"color:#75715e\"\u003e# Convert TB to MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            total_hdd_mb \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e capacity  \u003cspan style=\"color:#75715e\"\u003e# Assuming TB is HDD by default\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GB\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# Extract numeric part and convert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            capacity \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e int(float(part\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GB\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estrip()))  \u003cspan style=\"color:#75715e\"\u003e# Extract numeric part\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;SSD\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                total_ssd_mb \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e capacity \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e  \u003cspan style=\"color:#75715e\"\u003e# Convert GB to MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;HDD\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                total_hdd_mb \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e capacity \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e  \u003cspan style=\"color:#75715e\"\u003e# Convert GB to MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Flash\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                total_flash_mb \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e capacity \u003cspan style=\"color:#f92672\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1024\u003c/span\u003e  \u003cspan style=\"color:#75715e\"\u003e# Convert GB to MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;MB\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#75715e\"\u003e# Extract numeric part and convert\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            capacity \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e int(float(part\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003esplit()[\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ereplace(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;MB\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estrip()))  \u003cspan style=\"color:#75715e\"\u003e# Extract numeric part\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;SSD\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                total_ssd_mb \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e capacity  \u003cspan style=\"color:#75715e\"\u003e# Already in MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;HDD\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                total_hdd_mb \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e capacity  \u003cspan style=\"color:#75715e\"\u003e# Already in MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e            \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Flash\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e part:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e                total_flash_mb \u003cspan style=\"color:#f92672\"\u003e+=\u003c/span\u003e capacity  \u003cspan style=\"color:#75715e\"\u003e# Already in MB\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e total_ssd_mb, total_hdd_mb, total_flash_mb\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Apply the function to the Storage column\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Storage_SSD_MB\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Storage_HDD_MB\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Storage_Flash_MB\u0026#39;\u003c/span\u003e]] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Memory\u0026#39;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eapply(process_storage)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eapply(pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eSeries)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Memory\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# GPU\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#66d9ef\"\u003edef\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egroup_gpu\u003c/span\u003e(gpu_name):\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Intel\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e gpu_name:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Intel\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Nvidia GeForce GTX\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e gpu_name:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Nvidia GTX\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Nvidia\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e gpu_name:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Nvidia\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelif\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;AMD\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#f92672\"\u003ein\u003c/span\u003e gpu_name:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;AMD Radeon\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#66d9ef\"\u003eelse\u003c/span\u003e:\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e        \u003cspan style=\"color:#66d9ef\"\u003ereturn\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Other\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GPU_Group\u0026#39;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Gpu\u0026#39;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eapply(group_gpu)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# One-hot encoding with gpu\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egpu_dummies \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget_dummies(df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GPU_Group\u0026#39;\u003c/span\u003e], prefix\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GPU\u0026#39;\u003c/span\u003e)\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(int)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econcat([df, gpu_dummies], axis\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;Gpu\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;GPU_Group\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# One-Hot Encoding with OS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eos_dummies \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eget_dummies(df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;OpSys\u0026#34;\u003c/span\u003e])\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(int)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e pd\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003econcat([df, os_dummies], axis\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003edrop(columns\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e[\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;OpSys\u0026#39;\u003c/span\u003e])\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Weight\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Weight\u0026#34;\u003c/span\u003e] \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df[\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Weight\u0026#34;\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003estr[:\u003cspan style=\"color:#f92672\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e]\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eastype(float)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprint(df\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003ecolumns)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eprint(df)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf\u003cspan style=\"color:#f92672\"\u003e.\u003c/span\u003eto_csv(\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;cleaned_laptops.csv\u0026#39;\u003c/span\u003e, index\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#66d9ef\"\u003eFalse\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"outlier-detection\"\u003eOutlier detection\u003c/h4\u003e\n\u003cp\u003eUna vez se encuentra la variable objetivo, se puede observar si existe algún outlier en los datos. Al ser pocos datos, se pueden analizar a simple vista, aunque luego se podrían utilizar tanto Excel como RapidMiner para una detección de outliers automatizada, que podrá eliminar algún outlier que no se vea a simple vista. En este caso en particular no parece haber ningún dato que sobresalga.\u003c/p\u003e\n\u003ch3 id=\"generación-del-proceso\"\u003eGeneración del proceso\u003c/h3\u003e\n\u003cp\u003eEl primer paso dentro del proceso de RapidMiner es el de importar los datos. Una vez importados se le asigna a la feature \u003ccode\u003eprice_euros\u003c/code\u003e como variable objetivo, y se envía el dataset a un bloque de feature selection. Esto es porque, a pesar de que manualmente fueron eliminados algunas columnas, utilizar la técnica de One-Hot Encoding generó muchas otras, por lo que se debe de evaluar cuáles son las más importantes para mantener en el proceso. Hay distintas formas de realizar feature selection, en este caso fueron utilizados algoritmos genéticos mediante el bloque \u003ccode\u003eOptimize selection (evolutionary)\u003c/code\u003e. Dentro de este bloque se realizó un cross-validation para separar el dataset en una parte de testing y otra de training, y adentro del mismo se aplicó el modelo.\nEl bloque de feature selection acepta pesos de los atributos, por lo que se añadió también un bloque de pesos por correlación, para que sepa cuales son los valores que más están relacionados con el precio de las laptops. Esto le permite al algoritmo genético saber que, por ejemplo, la RAM es extremadamente importante a la hora de determinar el precio, pero quizas algún otro elemento no lo sea tanto.\u003c/p\u003e\n\u003cp\u003eEste proceso de feature selection nos permite reducir significativamente la cantidad de predictores que existen en el dataset actual, pasando de unas 54 columnas a unas 34, eliminando aproximadamente unas 20 columnas que no aportan (o incluso aportan ruido) al modelo.\u003c/p\u003e\n\u003cp\u003ePara este caso en particular, se debe usar un modelo que permita regresión, por lo que algunos candidatos son linear regression o desicion trees. En este caso en concreto, utilizar árboles de desición puede ser una buena idea, ya que hay muchas columnas binarias debido al One-Hot Encoding, y puede ser beneficioso aprovecharse de esto (por ejemplo, el árbol puede fijarse si la laptop es Apple o no, y según el resultado se fija si tiene Intel i5 o no, etc.).\u003c/p\u003e\n\u003cp\u003ePor como se realizó la preparación de los datos, es necesario normalizar. Un ejemplo de esto es el almacenamiento, que al ser convertido a MB, los valores quedaron enormemente más grandes que el resto de los valores del dataset. Esto puede causarle problemas al algoritmo, por lo que se agregó un bloque de normalización previo al modelo.\u003c/p\u003e\n\u003ch3 id=\"resultados\"\u003eResultados\u003c/h3\u003e\n\u003cp\u003eProceso en RapidMiner:\u003c/p\u003e\n\u003cimg src=\"../../images/Process1_1.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\n\u003cimg src=\"../../images/Process1_2.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\n\u003cimg src=\"../../images/Process1_3.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\nVista de resultados obtenidos:\n\u003cimg src=\"../../images/Results.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\nA primera vista los resultados podrían ser válidos pero al ver los resultados de performance:\n\u003cimg src=\"../../images/Errors.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\nSe puede ver que tiene mucho margen de error, lo cual no es deseable. Un RMSE de 300 implica que las predicciones del modelo están desviadas por 300 euros, que en el caso de las laptops no es poco. Por otro lado el Squared Error puede ser alto cuando hay diferencias significativas entre los valores predichos y sus respectivos valores reales, por lo que un valor tan alto implica que el desempeño del modelo es insatisfactorio. Hay que analizar que puntos fueron los que llevaron a este valor para poder modificarlos.\n\u003cimg src=\"../../images/Weights.jpg\" alt=\"drawing\" width=\"50%\" style=\"display: block; margin-left: auto; margin-right: auto; margin-bottom: 5%; width: 50%;\"/\u003e\nAquí se puede ver cuales fueron las columnas removidas por el algoritmo genético. Se puede ver que dejó fuera algunos atributos que a primera vista podrían ser interesantes, como Apple, cuyas laptops suelen ser de mayor precio que otras marcas. Habría que analizar que tanto afecta esto al valor final.  \n\u003cbr\u003e\u003c/br\u003e\nLos resultados hasta ahora no son los ideales, dado que el error que tiene es demasiado grande como para realizar una predicción acertada. Es necesario seguir evaluando los resultados que va generando el algoritmo para ir mejorando cada vez más sus predicciones, hasta llegar a un resultado que se considere aceptable para el caso de uso que se le quiera dar.\n\u003cbr\u003e\u003c/br\u003e\n\u003ch4 id=\"bibliografía\"\u003eBibliografía\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.kaggle.com/datasets/muhammetvarl/laptop-price\"\u003eDataset\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/@aniketjayant953/forecasting-laptop-costs-a-machine-learning-approach-3dbcf9bbf5c6\"\u003eOtros estudios del dataset\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://youtu.be/A1eU51jPpXQ\"\u003eOtros estudios del dataset\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","description":null,"image":null,"permalink":"https://seba-quintana.github.io/ML-Portfolio/blogs/laptops/","title":"Precios de laptops"}]